## 5.1 Подготовка признаков. One-hot-encoding. Scalers: MinMax, MaxAbs, Standard, Robust.
[Момент в лекции](https://youtu.be/j1zFT3ep6O0?list=PLxMpIvWUjaJsttwLkYi-uEydy6R9Hk2-v&t=3129)

### Проблемы: 
1. Пусть есть метрическое пространство, считаем евклидово расстояние. Но по некорые фичи могут иметь слишком маленький разброс относительно других фич, поэтому почти не окажут влияние на расстояние. Хотим уметь масштабировать и нормализовывать данные. 
2. Даны категориальные фичи, хотим уметь представлять их как числа, не создавая ложный порядок и расстояние. 


### One-hot-encoding
One-hot-encoding (OHE) используется для преобразования категориальных фич в числовой формат. Каждая уникальная категория превращается в отдельный бинарный столбец. 

#### Пример:
| Цвет   | red | green | blue |
|--------|---------|-------|---------|
| red| 1 | 0 | 0
| green  |0 | 1 | 0
| blue|0|0|1

Таким образом между всеми точками получаем одинаковое расстояние, нет отношения порядка. Минус: увеличивает размерность данных. 

### Scalers (масштабирование)

#### MinMaxScaler
 **Формула**:  
  $x_{scaled}=\frac{x-min(x)}{max(x)-min(x)} * (max-min)+min$
  
   
- Приводит значения фич в диапазон $[min, max]$, обычно $[0, 1]$.
- $min(x),\ max(x)$ минимум\максимум в тренировочных данных. Они же берутся для валидационных и тестовых данных.   
- Чувствителен к выбросам


#### MaxAbsScaler
 Масштабирует фичи относительно их максимального абсолютного значения.

**Формула**:  
  $x_{scaled} = \frac{x}{\max(|x|)}$

- Сохраняет разреженность (sparsity) данных (нули это хорошо, например для матричных вычислений)

#### StandardScaler
Переводит в нормальное распределение

**Формула**:  
    $x_{scaled} = \frac{x - mean(x)}{std(x)}$
- $mean(x)$ - среднее значние, $std(x)$ - стандартное отклонение
- Подходит для фич, распределённых близко к нормальному распределению.

<img src=https://github.com/itsahologram/ml-questions/blob/master/tickets/images/ticket05_1.png alt="Scalers" width="600" align="center">


#### RobustScaler
 Устойчив к выбросам. Берёт среднюю часть точек и нормирует её. Расстояние до выбросов остаётся большим.

 **Формула**:  
  $x_{scaled} = \frac{x - median(x)}{percentile_{max}(x)-percentile_{min}(x)}$
  
  Обычно  
$x_{scaled} = \frac{x - median(x)}{percentile_{0.75}(x)-percentile_{0.25}(x)}$

<img src=https://github.com/itsahologram/ml-questions/blob/master/tickets/images/ticket05_2.png alt="Robust" width="600" align="center">